{"ast":null,"code":"import _defineProperty from\"C:/Development/11312/client/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/Development/11312/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Development/11312/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import classNames from\"classnames\";import{useState}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import{useNavigate}from\"react-router-dom\";import{authUserIfUserExist}from\"../../store/Auth/Thunks/authUserIfUserExist\";import{selectUserErrorMessage,selectUserAuthenticated}from\"../../store/Auth/selectors\";import logo from\"./images/logo.png\";import styles from\"./styles.module.css\";import{useEffect}from\"react\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var FormElement=function FormElement(){var _classNames3;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),passwordVisible=_useState6[0],setPasswordVisible=_useState6[1];var _useState7=useState({isValid:true,errorMessage:\" \"}),_useState8=_slicedToArray(_useState7,2),validate=_useState8[0],setValidate=_useState8[1];var isSuccessAuth=useSelector(function(state){return selectUserAuthenticated(state);});var navigate=useNavigate();var dispatch=useDispatch();var errorMessage=useSelector(function(state){return selectUserErrorMessage(state);});var user=localStorage.userId;useEffect(function(){if(user){navigate(\"/cabinet\");}setValidate(_objectSpread(_objectSpread({},validate),{},{isValid:true}));},[isSuccessAuth]);var handleValidate=function handleValidate(){var lastAtPos=email.lastIndexOf(\"@\");var lastDotPos=email.lastIndexOf(\".\");if(!email||!password){setValidate({isValid:false,errorMessage:\"Введите логин и пароль!\"});}else if(!(lastAtPos<lastDotPos&&lastAtPos>0&&email.indexOf(\"@@\")===-1&&lastDotPos>2&&email.length-lastDotPos>2)){setValidate({isValid:false,errorMessage:\"Неверный формат электронной почты\"});}else if(errorMessage){setValidate({isValid:false,errorMessage:\"Неверный логин или пароль!\"});}else{setValidate({isValid:true,errorMessage:\" \"});}};var handleSubmit=function handleSubmit(event){dispatch(authUserIfUserExist({email:email,password:password}));event.preventDefault();handleValidate();};var togglePasswordVisible=function togglePasswordVisible(){setPasswordVisible(!passwordVisible);};return/*#__PURE__*/_jsx(\"div\",{className:styles.login_formWrapper,children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:styles.form,children:[/*#__PURE__*/_jsx(\"img\",{src:logo,alt:\"logo\",className:styles.form_logo}),/*#__PURE__*/_jsxs(\"div\",{className:styles.input_container,children:[/*#__PURE__*/_jsx(\"input\",{autoComplete:\"new-password\",id:\"login\",type:\"text\",className:classNames(styles.form_input,_defineProperty({},styles.form_input__invalid,!validate.isValid)),placeholder:\" \",value:email,onChange:function onChange(event){return setEmail(event.target.value);}}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"login\",className:styles.form_label,children:\"\\u041B\\u043E\\u0433\\u0438\\u043D\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.input_container,children:[/*#__PURE__*/_jsx(\"input\",{autoComplete:\"new-password\",id:\"password\",type:passwordVisible?\"text\":\"password\",className:classNames(styles.form_input,_defineProperty({},styles.form_input__invalid,!validate.isValid)),placeholder:\" \",value:password,onChange:function onChange(event){return setPassword(event.target.value);}}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",className:styles.form_label,children:\"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\"}),/*#__PURE__*/_jsx(\"button\",{className:classNames((_classNames3={},_defineProperty(_classNames3,styles.form_hideButton,passwordVisible),_defineProperty(_classNames3,styles.form_hidePuttonFilled,!passwordVisible),_classNames3)),type:\"button\",onClick:togglePasswordVisible})]}),/*#__PURE__*/_jsx(\"span\",{className:styles.errorMessage,children:validate.errorMessage}),/*#__PURE__*/_jsx(\"button\",{className:styles.form_submit,type:\"submit\",children:\"\\u0412\\u043E\\u0439\\u0442\\u0438\"}),/*#__PURE__*/_jsx(\"button\",{className:styles.form_forget,type:\"button\",children:\"\\u0417\\u0430\\u0431\\u044B\\u043B\\u0438 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C?\"})]})});};","map":{"version":3,"names":["classNames","useState","useDispatch","useSelector","useNavigate","authUserIfUserExist","selectUserErrorMessage","selectUserAuthenticated","logo","styles","useEffect","FormElement","email","setEmail","password","setPassword","passwordVisible","setPasswordVisible","isValid","errorMessage","validate","setValidate","isSuccessAuth","state","navigate","dispatch","user","localStorage","userId","handleValidate","lastAtPos","lastIndexOf","lastDotPos","indexOf","length","handleSubmit","event","preventDefault","togglePasswordVisible","login_formWrapper","form","form_logo","input_container","form_input","form_input__invalid","target","value","form_label","form_hideButton","form_hidePuttonFilled","form_submit","form_forget"],"sources":["C:/Development/11312/client/src/Components/FormElement/FormElement.jsx"],"sourcesContent":["import classNames from \"classnames\";\r\nimport { useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { authUserIfUserExist } from \"../../store/Auth/Thunks/authUserIfUserExist\";\r\nimport {\r\n  selectUserErrorMessage,\r\n  selectUserAuthenticated,\r\n} from \"../../store/Auth/selectors\";\r\nimport logo from \"./images/logo.png\";\r\nimport styles from \"./styles.module.css\";\r\nimport { useEffect } from \"react\";\r\n\r\nexport const FormElement = () => {\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [passwordVisible, setPasswordVisible] = useState(false);\r\n  const [validate, setValidate] = useState({\r\n    isValid: true,\r\n    errorMessage: \" \",\r\n  });\r\n  const isSuccessAuth = useSelector((state) => selectUserAuthenticated(state));\r\n  const navigate = useNavigate();\r\n  const dispatch = useDispatch();\r\n  const errorMessage = useSelector((state) => selectUserErrorMessage(state));\r\n  const user = localStorage.userId;\r\n  useEffect(() => {\r\n    if (user) {\r\n      navigate(\"/cabinet\");\r\n    }\r\n    setValidate({ ...validate, isValid: true });\r\n  }, [isSuccessAuth]);\r\n\r\n  const handleValidate = () => {\r\n    let lastAtPos = email.lastIndexOf(\"@\");\r\n    let lastDotPos = email.lastIndexOf(\".\");\r\n    if (!email || !password) {\r\n      setValidate({ isValid: false, errorMessage: \"Введите логин и пароль!\" });\r\n    } else if (\r\n      !(\r\n        lastAtPos < lastDotPos &&\r\n        lastAtPos > 0 &&\r\n        email.indexOf(\"@@\") === -1 &&\r\n        lastDotPos > 2 &&\r\n        email.length - lastDotPos > 2\r\n      )\r\n    ) {\r\n      setValidate({\r\n        isValid: false,\r\n        errorMessage: \"Неверный формат электронной почты\",\r\n      });\r\n    } else if (errorMessage) {\r\n      setValidate({\r\n        isValid: false,\r\n        errorMessage: \"Неверный логин или пароль!\",\r\n      });\r\n    } else {\r\n      setValidate({ isValid: true, errorMessage: \" \" });\r\n    }\r\n  };\r\n\r\n  const handleSubmit = (event) => {\r\n    dispatch(authUserIfUserExist({ email, password }));\r\n    event.preventDefault();\r\n    handleValidate();\r\n  };\r\n\r\n  const togglePasswordVisible = () => {\r\n    setPasswordVisible(!passwordVisible);\r\n  };\r\n\r\n  return (\r\n    <div className={styles.login_formWrapper}>\r\n      <form onSubmit={handleSubmit} className={styles.form}>\r\n        <img src={logo} alt=\"logo\" className={styles.form_logo} />\r\n        <div className={styles.input_container}>\r\n          <input\r\n            autoComplete=\"new-password\"\r\n            id=\"login\"\r\n            type=\"text\"\r\n            className={classNames(styles.form_input, {\r\n              [styles.form_input__invalid]: !validate.isValid,\r\n            })}\r\n            placeholder=\" \"\r\n            value={email}\r\n            onChange={(event) => setEmail(event.target.value)}\r\n          />\r\n          <label htmlFor=\"login\" className={styles.form_label}>\r\n            Логин\r\n          </label>\r\n        </div>\r\n        <div className={styles.input_container}>\r\n          <input\r\n            autoComplete=\"new-password\"\r\n            id=\"password\"\r\n            type={passwordVisible ? \"text\" : \"password\"}\r\n            className={classNames(styles.form_input, {\r\n              [styles.form_input__invalid]: !validate.isValid,\r\n            })}\r\n            placeholder=\" \"\r\n            value={password}\r\n            onChange={(event) => setPassword(event.target.value)}\r\n          />\r\n          <label htmlFor=\"password\" className={styles.form_label}>\r\n            Пароль\r\n          </label>\r\n          <button\r\n            className={classNames({\r\n              [styles.form_hideButton]: passwordVisible,\r\n              [styles.form_hidePuttonFilled]: !passwordVisible,\r\n            })}\r\n            type=\"button\"\r\n            onClick={togglePasswordVisible}\r\n          ></button>\r\n        </div>\r\n        <span className={styles.errorMessage}>{validate.errorMessage}</span>\r\n        <button className={styles.form_submit} type=\"submit\">\r\n          Войти\r\n        </button>\r\n        <button className={styles.form_forget} type=\"button\">\r\n          Забыли пароль?\r\n        </button>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}