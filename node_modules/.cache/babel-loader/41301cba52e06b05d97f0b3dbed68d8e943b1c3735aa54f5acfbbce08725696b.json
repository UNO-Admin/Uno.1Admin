{"ast":null,"code":"import _objectSpread from\"D:/dev/uno/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"D:/dev/uno/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import classNames from\"classnames\";import{useEffect,useState}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import{selectFranshisesIds}from\"../../store/Franshises/selectors\";import{addObject}from\"../../store/Objects/Thunks/addObject\";import{FormElem}from\"../FormElem/FormElem\";import{InputPhone}from\"../InputPhone/InputPhone\";import{InputText}from\"../InputText/InputText\";import{Option}from\"../Option/Option\";import styles from\"./styles.module.css\";import{isEmpty,isMobilePhone}from\"validator\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var AddObjectForm=function AddObjectForm(_ref){var togglePopup=_ref.togglePopup;var dispatch=useDispatch();var initialValidate={validate:undefined,errorMessage:\" \"};var franshisesIds=useSelector(function(state){return selectFranshisesIds(state);});var _useState=useState(initialValidate),_useState2=_slicedToArray(_useState,2),validate=_useState2[0],setValidate=_useState2[1];useEffect(function(){if(validate.errorMessage.length<5&&form.phone.length>7){dispatch(addObject(_objectSpread(_objectSpread({},form),{},{userId:userId})));togglePopup();}},[validate.errorMessage]);var _useState3=useState({name:\"\",idFran:franshisesIds[0],orgOwner:\"\",phone:\"\",worker:\"\"}),_useState4=_slicedToArray(_useState3,2),form=_useState4[0],setForm=_useState4[1];var userId=localStorage.userId;var handleValidate=function handleValidate(){if(Object.values(form).some(function(el){return isEmpty(el);})){setValidate({errorMessage:\"Необходимо заполнить все поля\",isValid:false});}else if(!isMobilePhone(form.phone)||form.phone.length<10){setValidate({errorMessage:\"Неверный формат номера телефона\",isValid:false});}else setValidate({isValid:true,errorMessage:\"   \"});return validate.isValid;};var onSubmit=function onSubmit(event){event.preventDefault();handleValidate();};return/*#__PURE__*/_jsxs(FormElem,{title:\"Добавление объекта\",onSubmit:onSubmit,children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:classNames(styles.button,styles.popup_closeButton),onClick:function onClick(){return togglePopup();}}),/*#__PURE__*/_jsx(InputText,{value:form.name,label:\"Наименование\",setValue:function setValue(e){return setForm(_objectSpread(_objectSpread({},form),{},{name:e}));}}),/*#__PURE__*/_jsxs(\"div\",{className:styles.input_container,children:[/*#__PURE__*/_jsx(\"select\",{size:1,defaultValue:1,id:\"idFran\",className:styles.form_input,required:true,placeholder:\" \",onChange:function onChange(event){return setForm(_objectSpread(_objectSpread({},form),{},{idFran:event.target.value}));},children:franshisesIds.map(function(id){return/*#__PURE__*/_jsx(Option,{idFran:id,form:form,setForm:setForm},id);})}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"idFran\",className:styles.form_label__select,children:\"\\u0424\\u0440\\u0430\\u043D\\u0448\\u0438\\u0437\\u0430\"})]}),/*#__PURE__*/_jsx(InputText,{value:form.orgOwner,label:\"Имя владельца\",setValue:function setValue(e){return setForm(_objectSpread(_objectSpread({},form),{},{orgOwner:e}));}}),/*#__PURE__*/_jsx(InputPhone,{label:\"Телефон\",value:form.phone,setValue:function setValue(e){return setForm(_objectSpread(_objectSpread({},form),{},{phone:e}));}}),/*#__PURE__*/_jsx(InputText,{label:\"Специалист\",value:form.worker,setValue:function setValue(e){return setForm(_objectSpread(_objectSpread({},form),{},{worker:e}));}}),/*#__PURE__*/_jsx(\"span\",{className:styles.errorMessage,children:validate.errorMessage}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:classNames(styles.button,styles.form_submit),children:\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u043E\\u0431\\u044A\\u0435\\u043A\\u0442\"})]});};","map":{"version":3,"names":["classNames","useEffect","useState","useDispatch","useSelector","selectFranshisesIds","addObject","FormElem","InputPhone","InputText","Option","styles","isEmpty","isMobilePhone","AddObjectForm","togglePopup","dispatch","initialValidate","validate","undefined","errorMessage","franshisesIds","state","setValidate","length","form","phone","userId","name","idFran","orgOwner","worker","setForm","localStorage","handleValidate","Object","values","some","el","isValid","onSubmit","event","preventDefault","button","popup_closeButton","e","input_container","form_input","target","value","map","id","form_label__select","form_submit"],"sources":["D:/dev/uno/src/Components/AddObjectForm/AddObjectForm.jsx"],"sourcesContent":["import classNames from \"classnames\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { selectFranshisesIds } from \"../../store/Franshises/selectors\";\r\nimport { addObject } from \"../../store/Objects/Thunks/addObject\";\r\nimport { FormElem } from \"../FormElem/FormElem\";\r\nimport { InputPhone } from \"../InputPhone/InputPhone\";\r\nimport { InputText } from \"../InputText/InputText\";\r\nimport { Option } from \"../Option/Option\";\r\nimport styles from \"./styles.module.css\";\r\nimport { isEmpty, isMobilePhone } from \"validator\";\r\n\r\nexport const AddObjectForm = ({ togglePopup }) => {\r\n  const dispatch = useDispatch();\r\n  const initialValidate = {\r\n    validate: undefined,\r\n    errorMessage: \" \",\r\n  };\r\n  const franshisesIds = useSelector((state) => selectFranshisesIds(state));\r\n  const [validate, setValidate] = useState(initialValidate);\r\n  useEffect(() => {\r\n    if (validate.errorMessage.length < 5 && form.phone.length > 7) {\r\n      dispatch(addObject({ ...form, userId }));\r\n      togglePopup();\r\n    }\r\n  }, [validate.errorMessage]);\r\n  const [form, setForm] = useState({\r\n    name: \"\",\r\n    idFran: franshisesIds[0],\r\n    orgOwner: \"\",\r\n    phone: \"\",\r\n    worker: \"\",\r\n  });\r\n\r\n  const userId = localStorage.userId;\r\n  const handleValidate = () => {\r\n    if (\r\n      Object.values(form).some(el => isEmpty(el))\r\n    ) {\r\n      setValidate({ errorMessage: \"Необходимо заполнить все поля\", isValid: false });\r\n    } else if(!isMobilePhone(form.phone) || form.phone.length < 10) {\r\n      setValidate({ errorMessage: \"Неверный формат номера телефона\", isValid: false });\r\n    } else setValidate({ isValid: true, errorMessage: \"   \" });\r\n    return validate.isValid;\r\n  };\r\n\r\n  const onSubmit = (event) => {\r\n    event.preventDefault();\r\n    handleValidate();\r\n  };\r\n\r\n  return (\r\n    <FormElem\r\n      title={\"Добавление объекта\"}\r\n      onSubmit={onSubmit}>\r\n      <button\r\n        type=\"button\"\r\n        className={classNames(styles.button, styles.popup_closeButton)}\r\n        onClick={() => togglePopup()}\r\n      />\r\n      <InputText\r\n        value={form.name}\r\n        label={\"Наименование\"}\r\n        setValue={(e) => setForm({ ...form, name: e })}\r\n      />\r\n      <div className={styles.input_container}>\r\n        <select\r\n          size={1}\r\n          defaultValue={1}\r\n          id=\"idFran\"\r\n          className={styles.form_input}\r\n          required\r\n          placeholder=\" \"\r\n          onChange={(event) =>\r\n            setForm({ ...form, idFran: event.target.value })\r\n          }>\r\n          {franshisesIds.map((id) => (\r\n            <Option\r\n              key={id}\r\n              idFran={id}\r\n              form={form}\r\n              setForm={setForm}\r\n            />\r\n          ))}\r\n        </select>\r\n        <label\r\n          htmlFor=\"idFran\"\r\n          className={styles.form_label__select}>\r\n          Франшиза\r\n        </label>\r\n      </div>\r\n      <InputText\r\n        value={form.orgOwner}\r\n        label={\"Имя владельца\"}\r\n        setValue={(e) => setForm({ ...form, orgOwner: e })}\r\n      />\r\n      <InputPhone\r\n        label={\"Телефон\"}\r\n        value={form.phone}\r\n        setValue={(e) => setForm({ ...form, phone: e })}\r\n      />\r\n      <InputText\r\n        label={\"Специалист\"}\r\n        value={form.worker}\r\n        setValue={(e) => setForm({ ...form, worker: e })}\r\n      />\r\n      <span className={styles.errorMessage}>{validate.errorMessage}</span>\r\n      <button\r\n        type=\"submit\"\r\n        className={classNames(styles.button, styles.form_submit)}>\r\n        Добавить объект\r\n      </button>\r\n    </FormElem>\r\n  );\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}